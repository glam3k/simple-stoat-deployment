# Root configuration for Stoat infrastructure
# Copy to .env and edit before running any deploy scripts.

# Required: base domain for your deployment (no protocol).
BASE_DOMAIN=ci.local

# Optional: per-service subdomains. Leave blank to serve from the bare base domain.
STOAT_SUBDOMAIN=chat
AUTH_SUBDOMAIN=sso
ADMIN_SUBDOMAIN=admin

# Optional: override full hostnames if they don't follow <subdomain>.<base_domain>.
# Uncomment and set to values like community.example.net to bypass subdomain derivation.
# STOAT_FQDN=
# AUTH_FQDN=
# ADMIN_FQDN=

# Set to 1 to use Caddy's internal CA instead of Let's Encrypt (handy for CI/local)
CADDY_USE_INTERNAL_CA=0

# Core resource tuning (per-VPS sizing)
STOAT_DB_CPUS=0.8
STOAT_DB_MEMORY=1g
STOAT_DB_MEMORY_RESERVATION=768m

STOAT_REDIS_CPUS=0.2
STOAT_REDIS_MEMORY=256m
STOAT_REDIS_MEMORY_RESERVATION=128m
STOAT_RABBIT_CPUS=0.2
STOAT_RABBIT_MEMORY=256m
STOAT_RABBIT_MEMORY_RESERVATION=128m

STOAT_MINIO_CPUS=0.2
STOAT_MINIO_MEMORY=256m
STOAT_MINIO_MEMORY_RESERVATION=128m

STOAT_API_CPUS=0.3
STOAT_API_MEMORY=512m
STOAT_API_MEMORY_RESERVATION=256m
STOAT_EVENTS_CPUS=0.3

STOAT_EVENTS_MEMORY=384m
STOAT_EVENTS_MEMORY_RESERVATION=192m
STOAT_WEB_CPUS=0.2
STOAT_WEB_MEMORY=256m
STOAT_WEB_MEMORY_RESERVATION=128m

# Authentik resource tuning (per-VPS sizing)
AUTHENTIK_POSTGRES_CPUS=0.3
AUTHENTIK_POSTGRES_MEMORY=384m
AUTHENTIK_POSTGRES_MEMORY_RESERVATION=256m
AUTHENTIK_REDIS_CPUS=0.1
AUTHENTIK_REDIS_MEMORY=128m
AUTHENTIK_REDIS_MEMORY_RESERVATION=64m

# Observability stack
OBSERVABILITY_ENABLED=1
GRAFANA_SUBDOMAIN=grafana
# GRAFANA_FQDN=
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=change_me
PROMTAIL_STATE_DIR=/opt/stoat/data/promtail
OBS_LOKI_DATA_DIR=/opt/stoat/data/loki
OBS_PROM_DATA_DIR=/opt/stoat/data/prometheus
OBS_GRAFANA_DATA_DIR=/opt/stoat/data/grafana
LOKI_RETENTION_DAYS=7
PROMETHEUS_RETENTION=7d
OBS_LOKI_CPUS=0.5
OBS_LOKI_MEMORY=512m
OBS_LOKI_MEMORY_RESERVATION=256m
OBS_PROMTAIL_CPUS=0.2
OBS_PROMTAIL_MEMORY=128m
OBS_PROMTAIL_MEMORY_RESERVATION=64m
OBS_PROMETHEUS_CPUS=0.5
OBS_PROMETHEUS_MEMORY=512m
OBS_PROMETHEUS_MEMORY_RESERVATION=256m
OBS_GRAFANA_CPUS=0.3
OBS_GRAFANA_MEMORY=256m
OBS_GRAFANA_MEMORY_RESERVATION=128m
OBS_NODE_EXPORTER_CPUS=0.1
OBS_NODE_EXPORTER_MEMORY=64m
OBS_CADVISOR_CPUS=0.2
OBS_CADVISOR_MEMORY=128m

# GitHub Container Registry (admin panel image)
GHCR_USER=
GHCR_TOKEN=
